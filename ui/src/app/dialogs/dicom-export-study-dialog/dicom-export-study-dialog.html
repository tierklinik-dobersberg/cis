<hlm-dialog-header>
  <h3 hlmDialogTitle>DICOM Studie exportieren</h3>
</hlm-dialog-header>

<div class="flex flex-col gap-4 p-2">
  @if (instances().length > 1) {
    <div class="flex flex-col gap-2">
      <label hlmLabel> Welche Bilder sollen exportiert werden? </label>

      <ol class="flex w-full flex-row gap-2 overflow-auto p-4">
        @for (instance of instances(); track instance.instanceUid) {
          <img
            role="button"
            [attr.src]="instance | dicomImageUrl: { width: 70, height: 70 }"
            (click)="instance.selected.set(!instance.selected())"
            class="aspect-auto h-16 w-16 cursor-pointer object-contain ring-2 ring-transparent ring-offset-2"
            [ngClass]="{ '!ring-sky-600': instance.selected() }" />
        }
      </ol>
    </div>
  }

  <div class="flex flex-col gap-2">
    <label hlmLabel> Was möchtest du exportieren? </label>

    <label hlmLabel class="flex items-center">
      <hlm-checkbox [(ngModel)]="exportDicom" class="mr-2" />
      DICOM
    </label>

    <label hlmLabel class="flex items-center">
      <hlm-checkbox [(ngModel)]="exportPNG" class="mr-2" />
      PNG
    </label>

    <label hlmLabel class="flex items-center">
      <hlm-checkbox [(ngModel)]="exportJPEG" class="mr-2" />
      JPEG
    </label>

    @if (showAvi()) {
      <label hlmLabel class="flex items-center">
        <hlm-checkbox [(ngModel)]="exportAVI" class="mr-2" />
        AVI
        <span class="text-xs text-gray-700"
          >(nur für multi-frame Aufnahmen)</span
        >
      </label>
    }
  </div>
</div>

<hlm-dialog-footer>
  <button
    hlmBtn
    variant="default"
    [disabled]="invalid() || exporting()"
    (click)="export()">
    {{ exporting() ? 'Export wird erstellt' : 'Exportieren' }}
  </button>

  <button hlmBtn variant="secondary" (click)="close()">Schließen</button>
</hlm-dialog-footer>
