<div class="flex overflow-hidden flex-row h-full">
  <div class="flex flex-col flex-shrink-0 gap-2 items-center w-24 bg-white border-r shadow-sm border-subtle">
    <div class="flex flex-col flex-grow items-center w-full">
      <ng-container *ngFor="let user of (users|keyvalue)">
        <div *ngIf="user.key | inList:allEligibleUsers" tkdDebounceEvent="mouseenter" tkdDebounceStopEvent="mouseleave" tkdDebounceEventTime="1000" (tkdOnEvent)="highlightUserShifts = user.key" (mouseleave)="highlightUserShifts = null" (click)="setSelectedUser(user.key)" [nz-tooltip]="user.value.fullname || user.key" nzTooltipPlacement="right" [ngClass]="{'bg-secondary-dark shadow-inner bg-opacity-40': selectedUser === user.key}" class="flex flex-col gap-1 items-center p-2 w-full border-b transition-colors duration-200 ease-out cursor-pointer border-subtle group hover:bg-secondary hover:bg-opacity-25">
          <nz-avatar [nzSize]="48" nzIcon="user" [nzSrc]="user.value.avatar" class="rounded-full transition-shadow duration-200 ease-in-out group-hover:ring-2" [ngClass]="{'ring-2 ring-alert-red': workTimeStatus[user.key]?.expectedWorkTime < workTimeStatus[user.key]?.plannedWorkTime, 'ring-2': selectedUser === user.key}"></nz-avatar>
          <span class="text-xs whitespace-nowrap font-lato text-secondary" *ngIf="workTimeStatus[user.key] as work">
            <span class="text-alert-red" [class.text-alert-green-dark]="work.expectedWorkTime > work.plannedWorkTime">{{ work.plannedWorkTime | duration:'default-hours':'ms' }}</span>/{{ work.expectedWorkTime | duration:'default-hours':'ms'}}
          </span>
        </div>
      </ng-container>
    </div>
    <div>
      <button class="tkd-icon-btn tkd-primary tkd-outline">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
        </svg>
      </button>
    </div>
  </div>

  <nz-calendar [nzDisabledDate]="dateDisabled" [nzValue]="selectedDate" nzMode="month" [nzFullscreen]="true" (nzPanelChange)="onPanelChange($event)" (nzSelectChange)="onDateSelected($event)" class="overflow-auto flex-grow">
    <div *nzDateFullCell="let date">
      <tkd-roster2-day (rosterShiftChange)="setRosterShifts(date, $event)" [offTimeRequest]="offTimeRequests" [rosterDate]="selectedDate" [date]="date" [holiday]="publicHolidays[date|date:'YYYY-MM-dd']" [users]="users" [shiftDefinitions]="shiftDefinitions" [requiredShifts]="requiredShifts[date|date:'YYYY-MM-dd']" [selectedUser]="selectedUser" [highlightUserShifts]="highlightUserShifts"></tkd-roster2-day>
    </div>
  </nz-calendar>
</div>